#!/bin/sh -e

FRAMERATE=30

INFO=$(xrandr | grep primary | awk '{print $4}')

WIDTH=$(echo "$INFO" | awk -Fx '{print $1}')
HEIGHT=$(echo "$INFO" | awk -Fx '{print $2}' | awk -F+ '{print $1}')
XOFFT=$(echo "$INFO" | awk -F+ '{print $2}')
YOFFT=$(echo "$INFO" | awk -F+ '{print $3}')

I=1
while [ -f recordscreen-${I}.mp4 ] ; do
    ((I++))
done

ffmpeg -video_size ${WIDTH}x${HEIGHT} \
    -framerate $FRAMERATE \
    -f x11grab \
    -i :0.0+${XOFFT},${YOFFT} \
    -c:v libx264 \
    -pix_fmt yuv420p \
    -preset fast \
    -crf 22 \
    recordscreen-${I}.mp4 || true

echo
echo Recorded to: recordscreen-${I}.mp4
